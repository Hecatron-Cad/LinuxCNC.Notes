{"_path":"/os/kernel/rpi3-usb","_dir":"kernel","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"RPI3 Fixes","description":"","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"rpi3-fixes"},"children":[{"type":"text","value":"RPI3 Fixes"}]},{"type":"element","tag":"h2","props":{"id":"usb-issues"},"children":[{"type":"text","value":"USB Issues"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"With the RPi3 it can have an issue with it's USB Controller when used in realtime."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://forums.raspberrypi.com/viewtopic.php?t=159170","rel":["nofollow"]},"children":[{"type":"text","value":"https://forums.raspberrypi.com/viewtopic.php?t=159170"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.osadl.org/Single-View.111+M5c03315dc57.0.html","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.osadl.org/Single-View.111+M5c03315dc57.0.html"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.osadl.org/monitoring/patches/rbs3s/usb-dwc_otg-fix-system-lockup-when-interrupts-are-threaded.patch.html","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.osadl.org/monitoring/patches/rbs3s/usb-dwc_otg-fix-system-lockup-when-interrupts-are-threaded.patch.html"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"One workaround is to add the following to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/boot/cmdline.txt"}]}]},{"type":"element","tag":"code","props":{"code":"dwc_otg.fiq_enable=0 dwc_otg.fiq_fsm_enable=0\n","language":"sh","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-7132c4"},"children":[{"type":"text","value":"dwc_otg.fiq_enable=0"}]},{"type":"element","tag":"span","props":{"class":"ct-c0efad"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8f4588"},"children":[{"type":"text","value":"dwc_otg.fiq_fsm_enable="}]},{"type":"element","tag":"span","props":{"class":"ct-8c2869"},"children":[{"type":"text","value":"0"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There was also another suggestion to also try "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dwc_otg.nak_holdoff=0"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nAfter rebooting the state can be checked with:"}]},{"type":"element","tag":"code","props":{"code":"dmesg | grep otg\n# Look for \"dwc_otg: FIQ disabled\"\n","language":"sh","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-7132c4"},"children":[{"type":"text","value":"dmesg"}]},{"type":"element","tag":"span","props":{"class":"ct-c0efad"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-12ea64"},"children":[{"type":"text","value":"|"}]},{"type":"element","tag":"span","props":{"class":"ct-c0efad"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7132c4"},"children":[{"type":"text","value":"grep"}]},{"type":"element","tag":"span","props":{"class":"ct-c0efad"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8f4588"},"children":[{"type":"text","value":"otg\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-759c51"},"children":[{"type":"text","value":"# Look for \"dwc_otg: FIQ disabled\""}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-759c51{color:#6E7781}\n.ct-12ea64{color:#CF222E}\n.ct-8c2869{color:#0550AE}\n.ct-8f4588{color:#0A3069}\n.ct-c0efad{color:#24292F}\n.ct-7132c4{color:#953800}\n.dark .ct-7132c4{color:#FFA657}\n.dark .ct-c0efad{color:#C9D1D9}\n.dark .ct-8f4588{color:#A5D6FF}\n.dark .ct-8c2869{color:#79C0FF}\n.dark .ct-12ea64{color:#FF7B72}\n.dark .ct-759c51{color:#8B949E}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"usb-issues","depth":2,"text":"USB Issues"}]}},"_type":"markdown","_id":"content:1.os:3.kernel:2.rpi3-usb.md","_source":"content","_file":"1.os/3.kernel/2.rpi3-usb.md","_extension":"md"}